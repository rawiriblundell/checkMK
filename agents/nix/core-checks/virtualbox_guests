# shellcheck shell=ksh
# vim: noai:ts=4:sw=4:expandtab

# Copyright (C) 2019 tribe29 GmbH - License: GNU General Public License v2
# This file is part of Checkmk (https://checkmk.com). It is subject to the terms and
# conditions defined in the file COPYING, which is part of this source code package.

# VirtualBox Guests. Section must always been output. Otherwise the
# check would not be executed in case no guest additions are installed.
# And that is something the check wants to detect
mkecho '<<<vbox_guest>>>'
if inpath VBoxControl; then
    if lsmod | grepq vboxguest; then
        VBoxControl -nologo guestproperty enumerate | cut -d, -f1,2
    fi
else
    mkecho "ERROR"
fi